coord_flip()
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
xlab("party affilation") +
ylab("") +
scale_y_continuous(limits = c(0,25),
labels = function(x) paste0(x, "%")) +
coord_flip()
charts_theme <- theme(axis.line.x = element_line("transparent", size = 0.5),
axis.line.y = element_line("transparent", size = 0.5),
axis.title.y.left = element_text(size = 12, margin = margin(r = 15)),
axis.title.y.right = element_text(size = 12, margin = margin(l = 15)),
axis.title.x = element_text(size = 12, margin = margin(t = 15)),
panel.border = element_rect(color = "#a3a3a3", fill = "transparent"),
panel.background = element_rect(fill = "white", color = "white"),
panel.grid.major = element_line(color = "#d4d4d4", linetype = 2),
plot.title = element_text(size = 14, hjust = 0.5),
plot.subtitle = element_text(size = 12, face = "italic", hjust = 0.5, margin = margin(b = 15)),
legend.background = element_rect(fill = "transparent"),
legend.text = element_text(size = 12),
legend.title = element_blank(),
legend.key = element_blank())
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
xlab("party affilation") +
ylab("") +
scale_y_continuous(limits = c(0,25),
labels = function(x) paste0(x, "%")) +
coord_flip()
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
xlab("party affilation") +
ylab("percent share in sample") +
scale_y_continuous(limits = c(0,25),
labels = function(x) paste0(x, "%")) +
coord_flip()
party_share <- party_share %>%
mutate(fct_recode(partyid,
"Other" = "No answer",
"Other" = "Don't know",
"Other" = "Other party"))
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
labs(title = "Share of Political Parties in Sample",
subtitle = "General Social Survey, 2000-2014")
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
labs(title = "Share of Political Parties in Sample",
subtitle = "General Social Survey, 2000-2014") +
xlab("party affilation") +
ylab("") +
scale_y_continuous(limits = c(0,25),
labels = function(x) paste0(x, "%")) +
coord_flip()
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
labs(title = "Share of Political Parties",
subtitle = "General Social Survey, 2000-2014") +
xlab("party affilation") +
ylab("") +
scale_y_continuous(limits = c(0,25),
labels = function(x) paste0(x, "%")) +
coord_flip()
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
labs(title = "Share of Political Parties",
subtitle = "General Social Survey, 2000-2014") +
xlab("party affilation") +
ylab("") +
scale_y_continuous(limits = c(0,25),
labels = function(x) paste0(x, "%")) +
coord_flip()
party_share <- party_share %>%
mutate(fct_recode(partyid,
"Other" = "No answer",
"Other" = "Don't know",
"Other" = "Other party"))
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
labs(title = "Share of Political Parties",
subtitle = "General Social Survey, 2000-2014") +
xlab("party affilation") +
ylab("") +
scale_y_continuous(limits = c(0,25),
labels = function(x) paste0(x, "%")) +
coord_flip()
party_share <- party_share %>%
mutate(party id = fct_recode(partyid,
party_share <- party_share %>%
mutate(partyid = fct_recode(partyid,
"Other" = "No answer",
"Other" = "Don't know",
"Other" = "Other party"))
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
labs(title = "Share of Political Parties",
subtitle = "General Social Survey, 2000-2014") +
xlab("party affilation") +
ylab("") +
scale_y_continuous(limits = c(0,25),
labels = function(x) paste0(x, "%")) +
coord_flip()
View(party_share)
data <- data %>%
mutate(partyid = fct_recode(partyid,
"Other" = "No answer",
"Other" = "Don't know",
"Other" = "Other party"))
party_share <- data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
select(!n)
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
labs(title = "Share of Political Parties",
subtitle = "General Social Survey, 2000-2014") +
xlab("party affilation") +
ylab("") +
scale_y_continuous(limits = c(0,25),
labels = function(x) paste0(x, "%")) +
coord_flip()
data$partyid <- fct_recode(data$partyid,
"Republican, strong"    = "Strong republican",
"Republican, weak"      = "Not str republican",
"Independent, near rep" = "Ind,near rep",
"Independent, near dem" = "Ind,near dem",
"Democrat, weak"        = "Not str democrat",
"Democrat, strong"      = "Strong democrat")
party_share <- data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
select(!n)
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
labs(title = "Share of Political Parties",
subtitle = "General Social Survey, 2000-2014") +
xlab("party affilation") +
ylab("") +
scale_y_continuous(limits = c(0,25),
labels = function(x) paste0(x, "%")) +
coord_flip()
data$partyid <- fct_recode(data$partyid,
"Republican, strong"    = "Strong republican",
"Republican, weak"      = "Not str republican",
"Independent, near rep" = "Ind,near rep",
"Independent, near dem" = "Ind,near dem",
"Democrat, weak"        = "Not str democrat",
"Democrat, strong"      = "Strong democrat")
party_share <- data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
select(!n)
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
labs(title = "Share of Political Parties",
subtitle = "General Social Survey, 2000-2014") +
xlab("party affilation") +
ylab("") +
scale_y_continuous(limits = c(0,25),
labels = function(x) paste0(x, "%")) +
coord_flip()
data <- data %>%
mutate(partyid = fct_recode(partyid,
"Republican, strong"    = "Strong republican",
"Republican, weak"      = "Not str republican",
"Independent, near rep" = "Ind,near rep",
"Independent, near dem" = "Ind,near dem",
"Democrat, weak"        = "Not str democrat",
"Democrat, strong"      = "Strong democrat"))
party_share <- data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
select(!n)
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
labs(title = "Share of Political Parties",
subtitle = "General Social Survey, 2000-2014") +
xlab("party affilation") +
ylab("") +
scale_y_continuous(limits = c(0,25),
labels = function(x) paste0(x, "%")) +
coord_flip()
party_share <- data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
select(!n)
data <- data %>% mutate(partyid =
fct_collapse(partyid,
Republican = str_subset(data$partyid, "Republican"),
Independent = str_subset(data$partyid, "Independent"),
Democrat = str_subset(data$partyid, "Democrat")))
party_share <- data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
select(!n)
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
labs(title = "Share of Political Parties",
subtitle = "General Social Survey, 2000-2014") +
xlab("party affilation") +
ylab("") +
scale_y_continuous(limits = c(0,25),
labels = function(x) paste0(x, "%")) +
coord_flip()
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
labs(title = "Share of Political Parties",
subtitle = "General Social Survey, 2000-2014") +
xlab("party affilation") +
ylab("") +
scale_y_continuous(limits = c(0,100),
labels = function(x) paste0(x, "%")) +
coord_flip()
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
labs(title = "Share of Political Parties",
subtitle = "General Social Survey, 2000-2014") +
xlab("party affilation") +
ylab("") +
scale_y_continuous(limits = c(0,50),
labels = function(x) paste0(x, "%")) +
coord_flip()
levels(data$marital)
data$marital <- fct_infreq(data$marital)
levels(data$marital)
party_share %>%
kable(col.names = c("Party", "% Share")) %>%
kable_paper() %>%
kable_styling(full_width = F, position = "center")
data <- gss_cat
party_share <- data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
select(!n)
party_share %>%
kable(col.names = c("Party", "% Share")) %>%
kable_paper() %>%
kable_styling(full_width = F, position = "center")
data <- data %>%
mutate(partyid = fct_lump(partyid, n = 5))
data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
select(!n) %>%
kable(col.names = c("Party", "% Share")) %>%
kable_paper() %>%
kable_styling(full_width = F, position = "center")
data <- data %>%
mutate(partyid = fct_lump(partyid, n = 6))
data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
select(!n) %>%
kable(col.names = c("Party", "% Share")) %>%
kable_paper() %>%
kable_styling(full_width = F, position = "center")
data <- data %>%
mutate(partyid = fct_lump(partyid, n = 5))
data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
select(!n) %>%
kable(col.names = c("Party", "% Share")) %>%
kable_paper() %>%
kable_styling(full_width = F, position = "center")
data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
mutate(partyid = fct_reorder(partyid, share)) %>%
select(!n) %>%
kable(col.names = c("Party", "% Share")) %>%
kable_paper() %>%
kable_styling(full_width = F, position = "center")
party_share <- data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
party_share %>%
mutate(partyid = fct_reorder(partyid, share)) %>%
select(!n) %>%
kable(col.names = c("Party", "% Share")) %>%
kable_paper() %>%
kable_styling(full_width = F, position = "center")
party_share <- data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
party_share %>%
mutate(partyid = fct_reorder(partyid, share)) %>%
select(!n) %>%
kable(col.names = c("Party", "% Share")) %>%
kable_paper() %>%
kable_styling(full_width = F, position = "center")
party_share <- data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2))
party_share %>%
mutate(partyid = fct_reorder(partyid, share)) %>%
select(!n) %>%
kable(col.names = c("Party", "% Share")) %>%
kable_paper() %>%
kable_styling(full_width = F, position = "center")
str(party_share)
View(party_share)
party_share %>%
mutate(partyid = fct_reorder(partyid, n)) %>%
select(!n) %>%
kable(col.names = c("Party", "% Share")) %>%
kable_paper() %>%
kable_styling(full_width = F, position = "center")
party_share <- data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
mutate(partyid = fct_reorder(partyid, n))
party_share %>%
select(!n) %>%
kable(col.names = c("Party", "% Share")) %>%
kable_paper() %>%
kable_styling(full_width = F, position = "center")
levels(party_share$partyid)
party_share %>%
select(!n) %>%
kable(col.names = c("Party", "% Share")) %>%
kable_paper() %>%
kable_styling(full_width = F, position = "center")
data <- data %>%
mutate(partyid = fct_lump(partyid, n = 5))
data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
select(!n) %>%
kable(col.names = c("Party", "% Share")) %>%
kable_paper() %>%
kable_styling(full_width = F, position = "center")
data <- gss_cat
data <- data %>%
mutate(partyid = fct_lump(partyid, n = 5))
levels(data$partyid)
data <- data %>%
mutate(partyid = fct_lump(partyid, n = 4))
levels(data$partyid)
data <- gss_cat
data <- data %>%
mutate(partyid = fct_lump(partyid, n = 4))
levels(data$partyid)
data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
select(!n) %>%
kable(col.names = c("Party", "% Share")) %>%
kable_paper() %>%
kable_styling(full_width = F, position = "center")
party_share <- data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
mutate(partyid = fct_reorder(partyid, n))
party_share %>%
select(!n) %>%
kable(col.names = c("Party", "% Share")) %>%
kable_paper() %>%
kable_styling(full_width = F, position = "center")
party_share <- data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2)) %>%
select(!n)
party_share <- data %>%
count(partyid) %>%
mutate(share = round(n/sum(n)*100, 2))
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
labs(title = "Share of Political Parties",
subtitle = "General Social Survey, 2000-2014") +
xlab("party affilation") +
ylab("") +
scale_y_continuous(limits = c(0,50),
labels = function(x) paste0(x, "%")) +
coord_flip()
party_share <- party_share %>%
mutate(partyid = fct_reorder(partyid, share))
ggplot(party_share, aes(x = partyid, y = share)) +
geom_point(color = "#007db7", stat = "identity", size = 6) +
geom_segment(aes(y = 0,
x = partyid,
yend = share,
xend = partyid),
color = "#007db7",
size = 1.5) +
charts_theme +
labs(title = "Share of Political Parties",
subtitle = "General Social Survey, 2000-2014") +
xlab("party affilation") +
ylab("") +
scale_y_continuous(limits = c(0,50),
labels = function(x) paste0(x, "%")) +
coord_flip()
